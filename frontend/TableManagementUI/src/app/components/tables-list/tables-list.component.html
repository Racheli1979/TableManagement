<div class="tables-container">
  <h2>Database Tables</h2>

  <input
    type="text"
    placeholder="Global search..."
    [(ngModel)]="searchTermGlobal"
    (input)="searchGlobalInput()"
  />

  <input
    type="text"
    placeholder="Filter by table name..."
    [(ngModel)]="searchTermTable"
    (input)="filterTables()"
  />

  <div *ngFor="let table of filteredTables" class="table-card">

    <div *ngIf="!isGlobalSearch" class="table-header">
      <strong>{{ table.tableName }}</strong>
    </div>

    <div *ngIf="isGlobalSearch" class="table-header" (click)="toggleExpand(table)">
      <strong>{{ table.tableName }}</strong>
      <span class="expand-icon">{{ table.expanded ? '▲' : '▼' }}</span>
    </div>

    <div *ngIf="table.expanded || isTableNameSearch">

      <ng-container *ngIf="isTableNameSearch">
        <div class="columns-list">
          <table>
            <thead>
              <tr>
                <th>Column Name</th>
                <!-- <th>Data Type</th> -->
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let col of table.columns">
                <td>{{ col.ColumnName }}</td>
                <!-- <td>{{ col.DataType }}</td> -->
              </tr>
            </tbody>
          </table>
        </div>
      </ng-container>

      <ng-container *ngIf="isGlobalSearch && table.rowData?.length">
        <div class="columns-list">
          <table>
            <thead>
              <tr>
                <th *ngFor="let col of getColumns(table.rowData?.[0])">{{ col }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let row of table.rowData">
                <td *ngFor="let col of getColumns(row)">{{ row[col] }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </ng-container>

    </div>

  </div>
</div>
